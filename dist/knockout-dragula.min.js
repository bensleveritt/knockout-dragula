!function(e,t){if("function"==typeof define&&define.amd)define(["exports","module","knockout","dragula"],t);else if("undefined"!=typeof exports&&"undefined"!=typeof module)t(exports,module,require("knockout"),require("dragula"));else{var n={exports:{}};t(n.exports,n,e.ko,e.dragula),e.knockoutDragula=n.exports}}(this,function(e,t,n,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function o(e){for(var t=0;t<w.length;t++)if(w[t].name===e)return w[t]}function u(e,t){var n={name:e,drake:t};return w.push(n),n}function d(e,t){var n=(0,m["default"])(t);return i(n),u(e,n)}function i(e){e.on("drop",s),e.on("remove",p),e.on("cancel",v)}function f(e,t){var n=e.drake.containers.indexOf(t);e.drake.containers.splice(n,1),e.drake.containers.length||l(e)}function l(e){var t=w.indexOf(e);w.splice(t,1),e.drake.destroy()}function c(e,t){var n=(0,m["default"])([e],t);return i(n),n}function s(e,t,n){var r=x["default"].dataFor(e),a=x["default"].contextFor(e),o=b(n,h),u=o.indexOf(r),d=b(t,h),i=Array.prototype.indexOf.call(t.children,e);t.removeChild(e),o.splice(u,1),d.splice(i,0,r);var f=b(t,y);f&&f.call(a,r,u,o,i,d)}function p(e,t){var n=x["default"].dataFor(e),r=b(t,h),a=r.indexOf(n),o=x["default"].contextFor(e);r.splice(a,1);var u=b(t,_);u&&u.call(o,n,a,r)}function v(e,t){var n=x["default"].dataFor(e),r=b(t,h),a=r.indexOf(n);t.removeChild(e),r.splice(a,1),r.splice(a,0,n)}function g(e,t){var n={data:t.data||e()};return D.forEach(function(e){t.hasOwnProperty(e)&&(n[e]=t[e])}),n}function k(e,t){var n=o(t.group);n?n.drake.containers.push(e):n=u(t.group,c(e,t)),q(e,function(){return f(n,e)})}var x=a(n),m=a(r),D=["afterAdd","afterMove","afterRender","as","beforeRemove"],h="ko_dragula_list",y="ko_dragula_afterDrop",_="ko_dragula_afterDelete",O=x["default"].unwrap,F=x["default"].utils.domData.set,b=x["default"].utils.domData.get,C=x["default"].bindingHandlers.foreach,q=x["default"].utils.domNodeDisposal.addDisposeCallback,w=[];x["default"].bindingHandlers.dragula={init:function(e,t,n,r,a){var o=O(t())||{},u=g(t,o);return F(e,h,u.data),F(e,y,o.afterDrop),F(e,_,o.afterDelete),C.init(e,function(){return u},n,r,a),o.group?k(e,o):!function(){var t=c(e,o);q(e,function(){return t.destroy()})}(),{controlsDescendantBindings:!0}},update:function(e,t,n,r,a){var o=O(t())||{},u=g(t,o);F(e,h,u.data),F(e,y,o.afterDrop),F(e,_,o.afterDelete),C.update(e,function(){return u},n,r,a)}},t.exports={add:u,options:d,find:o,destroy:l}});