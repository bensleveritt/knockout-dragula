!function(e,n){if("function"==typeof define&&define.amd)define(["exports","module","knockout","dragula"],n);else if("undefined"!=typeof exports&&"undefined"!=typeof module)n(exports,module,require("knockout"),require("dragula"));else{var t={exports:{}};n(t.exports,t,e.ko,e.dragula),e.knockoutDragula=t.exports}}(this,function(e,n,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function o(e){for(var n=0;n<w.length;n++)if(w[n].name===e)return w[n]}function d(e,n){var t={name:e,drake:n};return w.push(t),t}function u(e,n){var t=(0,m["default"])(n);return i(t),d(e,t)}function i(e){e.on("drop",s),e.on("remove",p),e.on("cancel",v)}function f(e,n){var t=e.drake.containers.indexOf(n);e.drake.containers.splice(t,1),e.drake.containers.length||l(e)}function l(e){var n=w.indexOf(e);w.splice(n,1),e.drake.destroy()}function c(e,n){var t=(0,m["default"])([e],n);return i(t),t}function s(e,n,t){var r=x["default"].dataFor(e),a=x["default"].contextFor(e),o=F(t,h),d=o.indexOf(r),u=F(n,h),i=Array.prototype.indexOf.call(n.children,e);n.removeChild(e),o.splice(d,1),u.splice(i,0,r);var f=F(n,y);f&&(f=f.bind(a))(r,d,o,i,u)}function p(e,n){var t=x["default"].dataFor(e),r=F(n,h),a=r.indexOf(t);r.splice(a,1);var o=F(n,_);o&&o(t,a,r)}function v(e,n){var t=x["default"].dataFor(e),r=F(n,h),a=r.indexOf(t);n.removeChild(e),r.splice(a,1),r.splice(a,0,t)}function g(e,n){var t={data:n.data||e()};return D.forEach(function(e){n.hasOwnProperty(e)&&(t[e]=n[e])}),t}function k(e,n){var t=o(n.group);t?t.drake.containers.push(e):t=d(n.group,c(e,n)),q(e,function(){return f(t,e)})}var x=a(t),m=a(r),D=["afterAdd","afterMove","afterRender","as","beforeRemove"],h="ko_dragula_list",y="ko_dragula_afterDrop",_="ko_dragula_afterDelete",O=x["default"].unwrap,b=x["default"].utils.domData.set,F=x["default"].utils.domData.get,C=x["default"].bindingHandlers.foreach,q=x["default"].utils.domNodeDisposal.addDisposeCallback,w=[];x["default"].bindingHandlers.dragula={init:function(e,n,t,r,a){var o=O(n())||{},d=g(n,o);return b(e,h,d.data),b(e,y,o.afterDrop),b(e,_,o.afterDelete),C.init(e,function(){return d},t,r,a),o.group?k(e,o):!function(){var n=c(e,o);q(e,function(){return n.destroy()})}(),{controlsDescendantBindings:!0}},update:function(e,n,t,r,a){var o=O(n())||{},d=g(n,o);b(e,h,d.data),b(e,y,o.afterDrop),b(e,_,o.afterDelete),C.update(e,function(){return d},t,r,a)}},n.exports={add:d,options:u,find:o,destroy:l}});